<!DOCTYPE HTML><html lang=""><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8"http-equiv="Content-Type"><title>C.28. Golang Web Socket: Chatting App - Dasar Pemrograman Golang</title><meta content="IE=edge"http-equiv="X-UA-Compatible"/><meta content=""name="description"><meta content="GitBook 3.2.3"name="generator"><link href="gitbook/style.css"rel="stylesheet"><link href="gitbook/gitbook-plugin-disqus/plugin.css"rel="stylesheet"><link href="gitbook/gitbook-plugin-highlight/website.css"rel="stylesheet"><link href="gitbook/gitbook-plugin-search/search.css"rel="stylesheet"><link href="gitbook/gitbook-plugin-fontsettings/website.css"rel="stylesheet"><link href="styles/website.css"rel="stylesheet"><meta content="UZnxS2Dk3fm2_Elms3a__56Q_oQ3sQ1h0SVXXlHSmbE"name="google-site-verification"><meta content="https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg"name="og:image"><meta content="https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg"name="twitter:image"><meta content="true"name="HandheldFriendly"/><meta content="width=device-width,initial-scale=1,user-scalable=no"name="viewport"><meta content="yes"name="apple-mobile-web-app-capable"><meta content="black"name="apple-mobile-web-app-status-bar-style"><link href="gitbook/images/apple-touch-icon-precomposed-152.png"rel="apple-touch-icon-precomposed"sizes="152x152"><link href="gitbook/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="C-29-golang-protobuf-implementation.html"rel="next"/><link href="C-27-golang-ssh-sftp.html"rel="prev"/></head><body><div class="book"><div class="book-summary"><div role="search"id="book-search-input"><input placeholder="Type to search"type="text"/></div><nav role="navigation"><ul class="summary"><li class="chapter"data-level="1.1"data-path="./"><a href="./">Introduction</a></li><li class="chapter"data-level="1.2"><span>A. Pemrograman Golang Dasar</span><ul class="articles"><li class="chapter"data-level="1.2.1"data-path="1-berkenalan-dengan-golang.html"><a href="1-berkenalan-dengan-golang.html">A.1. Berkenalan Dengan Golang</a></li><li class="chapter"data-level="1.2.2"data-path="2-instalasi-golang.html"><a href="2-instalasi-golang.html">A.2. Instalasi Golang</a></li><li class="chapter"data-level="1.2.3"data-path="3-gopath-dan-workspace.html"><a href="3-gopath-dan-workspace.html">A.3. GOPATH Dan Workspace</a></li><li class="chapter"data-level="1.2.4"data-path="4-instalasi-editor.html"><a href="4-instalasi-editor.html">A.4. Instalasi Editor</a></li><li class="chapter"data-level="1.2.5"data-path="5-go-command.html"><a href="5-go-command.html">A.5. Command</a></li><li class="chapter"data-level="1.2.6"data-path="6-hello-world.html"><a href="6-hello-world.html">A.6. Program Pertama: Hello World</a></li><li class="chapter"data-level="1.2.7"data-path="7-komentar.html"><a href="7-komentar.html">A.7. Komentar</a></li><li class="chapter"data-level="1.2.8"data-path="8-variabel.html"><a href="8-variabel.html">A.8. Variabel</a></li><li class="chapter"data-level="1.2.9"data-path="9-tipe-data.html"><a href="9-tipe-data.html">A.9. Tipe Data</a></li><li class="chapter"data-level="1.2.10"data-path="10-konstanta.html"><a href="10-konstanta.html">A.10. Konstanta</a></li><li class="chapter"data-level="1.2.11"data-path="11-operator.html"><a href="11-operator.html">A.11. Operator</a></li><li class="chapter"data-level="1.2.12"data-path="12-seleksi-kondisi.html"><a href="12-seleksi-kondisi.html">A.12. Seleksi Kondisi</a></li><li class="chapter"data-level="1.2.13"data-path="13-perulangan.html"><a href="13-perulangan.html">A.13. Perulangan</a></li><li class="chapter"data-level="1.2.14"data-path="14-array.html"><a href="14-array.html">A.14. Array</a></li><li class="chapter"data-level="1.2.15"data-path="15-slice.html"><a href="15-slice.html">A.15. Slice</a></li><li class="chapter"data-level="1.2.16"data-path="16-map.html"><a href="16-map.html">A.16. Map</a></li><li class="chapter"data-level="1.2.17"data-path="17-fungsi.html"><a href="17-fungsi.html">A.17. Fungsi</a></li><li class="chapter"data-level="1.2.18"data-path="18-fungsi-multiple-return.html"><a href="18-fungsi-multiple-return.html">A.18. Fungsi Multiple Return</a></li><li class="chapter"data-level="1.2.19"data-path="19-fungsi-variadic.html"><a href="19-fungsi-variadic.html">A.19. Fungsi Variadic</a></li><li class="chapter"data-level="1.2.20"data-path="20-fungsi-closure.html"><a href="20-fungsi-closure.html">A.20. Fungsi Closure</a></li><li class="chapter"data-level="1.2.21"data-path="21-fungsi-sebagai-parameter.html"><a href="21-fungsi-sebagai-parameter.html">A.21. Fungsi Sebagai parameter</a></li><li class="chapter"data-level="1.2.22"data-path="22-pointer.html"><a href="22-pointer.html">A.22. Pointer</a></li><li class="chapter"data-level="1.2.23"data-path="23-struct.html"><a href="23-struct.html">A.23. Struct</a></li><li class="chapter"data-level="1.2.24"data-path="24-method.html"><a href="24-method.html">A.24. Method</a></li><li class="chapter"data-level="1.2.25"data-path="25-properti-public-dan-private.html"><a href="25-properti-public-dan-private.html">A.25. Property Public & Private</a></li><li class="chapter"data-level="1.2.26"data-path="26-interface.html"><a href="26-interface.html">A.26. Interface</a></li><li class="chapter"data-level="1.2.27"data-path="27-interface-kosong.html"><a href="27-interface-kosong.html">A.27. Interface Kosong</a></li><li class="chapter"data-level="1.2.28"data-path="28-reflect.html"><a href="28-reflect.html">A.28. Reflect</a></li><li class="chapter"data-level="1.2.29"data-path="29-goroutine.html"><a href="29-goroutine.html">A.29. Goroutine</a></li><li class="chapter"data-level="1.2.30"data-path="30-channel.html"><a href="30-channel.html">A.30. Channel</a></li><li class="chapter"data-level="1.2.31"data-path="31-buffered-channel.html"><a href="31-buffered-channel.html">A.31. Buffered Channel</a></li><li class="chapter"data-level="1.2.32"data-path="32-channel-select.html"><a href="32-channel-select.html">A.32. Channel - Select</a></li><li class="chapter"data-level="1.2.33"data-path="33-channel-range-close.html"><a href="33-channel-range-close.html">A.33. Channel - Range & Close</a></li><li class="chapter"data-level="1.2.34"data-path="34-channel-timeout.html"><a href="34-channel-timeout.html">A.34. Channel - Timeout</a></li><li class="chapter"data-level="1.2.35"data-path="35-defer-exit.html"><a href="35-defer-exit.html">A.35. Defer & Exit</a></li><li class="chapter"data-level="1.2.36"data-path="36-error-panic-recover.html"><a href="36-error-panic-recover.html">A.36. Error, Panic, & Recover</a></li><li class="chapter"data-level="1.2.37"data-path="37-string-format.html"><a href="37-string-format.html">A.37. Layout Format String</a></li><li class="chapter"data-level="1.2.38"data-path="38-time.html"><a href="38-time.html">A.38. Time, Parsing Time, & Format Time</a></li><li class="chapter"data-level="1.2.39"data-path="39-timer.html"><a href="39-timer.html">A.39. Timer</a></li><li class="chapter"data-level="1.2.40"data-path="40-data-type-conversion.html"><a href="40-data-type-conversion.html">A.40. Konversi Antar Tipe Data</a></li><li class="chapter"data-level="1.2.41"data-path="41-strings.html"><a href="41-strings.html">A.41. Fungsi String</a></li><li class="chapter"data-level="1.2.42"data-path="42-regex.html"><a href="42-regex.html">A.42. Regex</a></li><li class="chapter"data-level="1.2.43"data-path="43-encoding-base64.html"><a href="43-encoding-base64.html">A.43. Encode - Decode Base64</a></li><li class="chapter"data-level="1.2.44"data-path="44-hash-sha1.html"><a href="44-hash-sha1.html">A.44. Hash Sha1</a></li><li class="chapter"data-level="1.2.45"data-path="45-command-line-args-flag.html"><a href="45-command-line-args-flag.html">A.45. Arguments & Flag</a></li><li class="chapter"data-level="1.2.46"data-path="46-exec.html"><a href="46-exec.html">A.46. Exec</a></li><li class="chapter"data-level="1.2.47"data-path="47-file.html"><a href="47-file.html">A.47. File</a></li><li class="chapter"data-level="1.2.48"data-path="48-web.html"><a href="48-web.html">A.48. Web</a></li><li class="chapter"data-level="1.2.49"data-path="49-url-parsing.html"><a href="49-url-parsing.html">A.49. URL Parsing</a></li><li class="chapter"data-level="1.2.50"data-path="50-json.html"><a href="50-json.html">A.50. JSON</a></li><li class="chapter"data-level="1.2.51"data-path="51-web-json-api.html"><a href="51-web-json-api.html">A.51. Web JSON API</a></li><li class="chapter"data-level="1.2.52"data-path="52-http-request.html"><a href="52-http-request.html">A.52. HTTP Request</a></li><li class="chapter"data-level="1.2.53"data-path="53-sql.html"><a href="53-sql.html">A.53. SQL</a></li><li class="chapter"data-level="1.2.54"data-path="54-mongodb.html"><a href="54-mongodb.html">A.54. NoSQL MongoDB</a></li><li class="chapter"data-level="1.2.55"data-path="55-unit-test.html"><a href="55-unit-test.html">A.55. Unit Test</a></li><li class="chapter"data-level="1.2.56"data-path="56-waitgroup.html"><a href="56-waitgroup.html">A.56. WaitGroup</a></li><li class="chapter"data-level="1.2.57"data-path="57-mutex.html"><a href="57-mutex.html">A.57. Mutex</a></li><li class="chapter"data-level="1.2.58"data-path="A-58-go-vendoring.html"><a href="A-58-go-vendoring.html">A.58. Go Vendoring</a></li><li class="chapter"data-level="1.2.59"data-path="A-59-go-dep.html"><a href="A-59-go-dep.html">A.59. Dep - Go Dependency Management Tool</a></li><li class="chapter"data-level="1.2.60"data-path="A-60-go-modules.html"><a href="A-60-go-modules.html">A.60. Go Modules</a></li></ul></li><li class="chapter"data-level="1.3"><span>B. Pemrograman Web Golang Dasar</span><ul class="articles"><li class="chapter"data-level="1.3.1"data-path="B-1-golang-web-hello-world.html"><a href="B-1-golang-web-hello-world.html">B.1. Golang Web App: Hello World</a></li><li class="chapter"data-level="1.3.2"data-path="B-2-routing-http-handlefunc.html"><a href="B-2-routing-http-handlefunc.html">B.2. Routing http.HandleFunc</a></li><li class="chapter"data-level="1.3.3"data-path="B-3-routing-static-assets.html"><a href="B-3-routing-static-assets.html">B.3. Routing Static Assets</a></li><li class="chapter"data-level="1.3.4"data-path="B-4-template-render-html.html"><a href="B-4-template-render-html.html">B.4. Template: Render HTML Template</a></li><li class="chapter"data-level="1.3.5"data-path="B-5-template-render-partial-html.html"><a href="B-5-template-render-partial-html.html">B.5. Template: Render Partial HTML Template</a></li><li class="chapter"data-level="1.3.6"data-path="B-6-template-actions-variables.html"><a href="B-6-template-actions-variables.html">B.6. Template: Actions & Variables</a></li><li class="chapter"data-level="1.3.7"data-path="B-7-template-functions.html"><a href="B-7-template-functions.html">B.7. Template: Functions</a></li><li class="chapter"data-level="1.3.8"data-path="B-8-template-custom-functions.html"><a href="B-8-template-custom-functions.html">B.8. Template: Custom Functions</a></li><li class="chapter"data-level="1.3.9"data-path="B-9-render-specific-html-template.html"><a href="B-9-render-specific-html-template.html">B.9. Template: Render Specific HTML Template</a></li><li class="chapter"data-level="1.3.10"data-path="B-10-render-html-string.html"><a href="B-10-render-html-string.html">B.10. Template: Render HTML String</a></li><li class="chapter"data-level="1.3.11"data-path="B-11-http-method.html"><a href="B-11-http-method.html">B.11. HTTP Method: POST & GET</a></li><li class="chapter"data-level="1.3.12"data-path="B-12-form-value.html"><a href="B-12-form-value.html">B.12. Form Value</a></li><li class="chapter"data-level="1.3.13"data-path="B-13-form-upload-file.html"><a href="B-13-form-upload-file.html">B.13. Form Upload File</a></li><li class="chapter"data-level="1.3.14"data-path="B-14-ajax-json-payload.html"><a href="B-14-ajax-json-payload.html">B.14. AJAX JSON Payload</a></li><li class="chapter"data-level="1.3.15"data-path="B-15-ajax-json-response.html"><a href="B-15-ajax-json-response.html">B.15. AJAX JSON Response</a></li><li class="chapter"data-level="1.3.16"data-path="B-16-ajax-multi-upload.html"><a href="B-16-ajax-multi-upload.html">B.16. AJAX Multiple File Upload</a></li><li class="chapter"data-level="1.3.17"data-path="B-17-download-file.html"><a href="B-17-download-file.html">B.17. Download File</a></li><li class="chapter"data-level="1.3.18"data-path="B-18-http-basic-auth.html"><a href="B-18-http-basic-auth.html">B.18. HTTP Basic Auth</a></li><li class="chapter"data-level="1.3.19"data-path="B-19-middleware-using-http-handler.html"><a href="B-19-middleware-using-http-handler.html">B.19. Middleware http.Handler</a></li><li class="chapter"data-level="1.3.20"data-path="B-20-custom-mux-multiplexer.html"><a href="B-20-custom-mux-multiplexer.html">B.20. Custom Multiplexer</a></li><li class="chapter"data-level="1.3.21"data-path="B-21-cookie.html"><a href="B-21-cookie.html">B.21. HTTP Cookie</a></li><li class="chapter"data-level="1.3.22"data-path="B-22-configuration-file.html"><a href="B-22-configuration-file.html">B.22. Configuration File</a></li></ul></li><li class="chapter"data-level="1.4"><span>C. Pemrograman Web Golang Lanjut</span><ul class="articles"><li class="chapter"data-level="1.4.1"data-path="C-1-echo-routing.html"><a href="C-1-echo-routing.html">C.1. Echo Framework & Routing</a></li><li class="chapter"data-level="1.4.2"data-path="C-2-parsing-http-request-payload-echo.html"><a href="C-2-parsing-http-request-payload-echo.html">C.2. Parsing HTTP Request Payload (Echo)</a></li><li class="chapter"data-level="1.4.3"data-path="C-3-http-request-payload-validation.html"><a href="C-3-http-request-payload-validation.html">C.3. HTTP Request Payload Validation (Validator v9, Echo)</a></li><li class="chapter"data-level="1.4.4"data-path="C-4-http-error-handling.html"><a href="C-4-http-error-handling.html">C.4. HTTP Error Handling (Validator v9, Echo)</a></li><li class="chapter"data-level="1.4.5"data-path="C-5-echo-template-rendering.html"><a href="C-5-echo-template-rendering.html">C.5. Template Rendering in Echo</a></li><li class="chapter"data-level="1.4.6"data-path="C-6-advanced-middleware-and-logging.html"><a href="C-6-advanced-middleware-and-logging.html">C.6. Advanced Middleware & Logging (Logrus, Echo Logger)</a></li><li class="chapter"data-level="1.4.7"data-path="C-7-flag-parser.html"><a href="C-7-flag-parser.html">C.7. CLI Flag Parser (Kingpin)</a></li><li class="chapter"data-level="1.4.8"data-path="C-8-advanced-configuration-file.html"><a href="C-8-advanced-configuration-file.html">C.8. Advanced Configuration File (Viper)</a></li><li class="chapter"data-level="1.4.9"data-path="C-9-securecookie.html"><a href="C-9-securecookie.html">C.9. Secure Cookie (Gorilla Securecookie)</a></li><li class="chapter"data-level="1.4.10"data-path="C-10-session.html"><a href="C-10-session.html">C.10. Session (Gorilla Session)</a></li><li class="chapter"data-level="1.4.11"data-path="C-12-cors-preflight-request.html"><a href="C-12-cors-preflight-request.html">C.12. CORS & Preflight Request</a></li><li class="chapter"data-level="1.4.12"data-path="C-13-csrf.html"><a href="C-13-csrf.html">C.13. CSRF</a></li><li class="chapter"data-level="1.4.13"data-path="C-14-secure-middleware.html"><a href="C-14-secure-middleware.html">C.14. Secure Middleware</a></li><li class="chapter"data-level="1.4.14"data-path="C-15-http-gzip-compression.html"><a href="C-15-http-gzip-compression.html">C.15. HTTP Gzip Compression (gziphandler)</a></li><li class="chapter"data-level="1.4.15"data-path="C-16-send-email.html"><a href="C-16-send-email.html">C.16. Send Mail (net/smtp, Gomail v2)</a></li><li class="chapter"data-level="1.4.16"data-path="C-17-read-write-excel-xlsx-file.html"><a href="C-17-read-write-excel-xlsx-file.html">C.17. Read & Write Excel XLSX File (Excelize)</a></li><li class="chapter"data-level="1.4.17"data-path="C-18-write-pdf-file.html"><a href="C-18-write-pdf-file.html">C.18. Write PDF File (gofpdf)</a></li><li class="chapter"data-level="1.4.18"data-path="C-19-convert-html-to-pdf.html"><a href="C-19-convert-html-to-pdf.html">C.19. Convert HTML to PDF (go-wkhtmltopdf)</a></li><li class="chapter"data-level="1.4.19"data-path="C-20-scraping-parsing-html.html"><a href="C-20-scraping-parsing-html.html">C.20. Scraping & Parsing HTML (goquery)</a></li><li class="chapter"data-level="1.4.20"data-path="C-21-xml-parser.html"><a href="C-21-xml-parser.html">C.21. Parse & Generate XML (etree)</a></li><li class="chapter"data-level="1.4.21"data-path="C-22-https-tls.html"><a href="C-22-https-tls.html">C.22. HTTPS/TLS Web Server</a></li><li class="chapter"data-level="1.4.22"data-path="C-23-http2-server-push.html"><a href="C-23-http2-server-push.html">C.23. HTTP/2 & HTTP/2 Server Push</a></li><li class="chapter"data-level="1.4.23"data-path="C-24-client-http-request.html"><a href="C-24-client-http-request.html">C.24. Client HTTP Request</a></li><li class="chapter"data-level="1.4.24"data-path="C-25-secure-insecure-client-http-request.html"><a href="C-25-secure-insecure-client-http-request.html">C.25. Secure & Insecure Client HTTP Request</a></li><li class="chapter"data-level="1.4.25"data-path="C-26-golang-ftp.html"><a href="C-26-golang-ftp.html">C.26. FTP</a></li><li class="chapter"data-level="1.4.26"data-path="C-27-golang-ssh-sftp.html"><a href="C-27-golang-ssh-sftp.html">C.27. SSH & SFTP</a></li><li class="chapter active"data-level="1.4.27"data-path="C-28-golang-web-socket.html"><a href="C-28-golang-web-socket.html">C.28. Web Socket: Chatting App</a></li><li class="chapter"data-level="1.4.28"data-path="C-29-golang-protobuf-implementation.html"><a href="C-29-golang-protobuf-implementation.html">C.29. Protobuf</a></li><li class="chapter"data-level="1.4.29"data-path="C-30-golang-grpc-protobuf.html"><a href="C-30-golang-grpc-protobuf.html">C.30. gRPC + Protobuf</a></li><li class="chapter"data-level="1.4.30"data-path="C-31-golang-context.html"><a href="C-31-golang-context.html">C.31. Context: Value, Timeout, & Cancellation</a></li><li class="chapter"data-level="1.4.31"data-path="C-32-golang-jwt.html"><a href="C-32-golang-jwt.html">C.32. JSON Web Token (JWT)</a></li></ul></li><li><a href="https://www.gitbook.com"target="blank"class="gitbook-link">Published with GitBook</a></li></ul></nav></div><div class="book-body"><div class="body-inner"><div class="book-header"role="navigation"><h1><a href=".">C.28. Web Socket: Chatting App</a></h1></div><div class="page-wrapper"role="main"tabindex="-1"><div class="page-inner"><div id="book-search-results"><div class="search-noresults"><section class="markdown-section normal"><h1 id="cb28-web-socket-chatting-app">CB.28. Web Socket: Chatting App</h1><p>Pada bab ini kita akan belajar penerapan web socket di golang, untuk membuat sebuah aplikasi chatting. Web socket server dibuat menggunakan library <a href="https://github.com/gorilla/websocket"target="_blank">Gorilla Web Socket</a>, dan di sisi front end kita menggunakan native API milik javascript yaitu <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_client_applications"target="_blank">WebSocket</a> untuk melakukan komunikasi dengan socket server.</p><blockquote><p>Jelasnya kapabilitas web socket bisa dicapai dengan cukup menggunakan default package yang disediakan golang. Namun pada bab ini pembelajaran dilakukan menggunakan 4rd party library.</p></blockquote><p>Seperti biasanya proses belajar dilakukan sambil praktek. Kita buat aplikasi chatting minimalis, dengan kode se-sedikit mungkin agar mudah dipahami, development dilakukan <em>from scratch</em>.</p><p>Nantinya saat testing akan ada banyak user terhubung dengan socket server, dalam satu room. Setiap pesan yang ditulis oleh salah seorang user, bisa dibaca oleh semua user lainnya.</p><p>Kurang lebih aplikasi yang kita kembangkan seperti gambar di bawah ini.</p><p><img alt="Chatting App"src="images/C.28_3_chatting.png"></p><h2 id="cb281-back-end">CB.28.1. Back End</h2><p>Buat folder projek baru, siapkan dua buah file: <code>main.go</code> dan <code>index.html</code>. Kita akan buat socket server terlebih dahulu. Silakan tulis kode berikut ke dalam <code>main.go</code>.</p><pre><code class="lang-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">&quot;fmt&quot;</span>
    <span class="hljs-string">&quot;github.com/gorilla/websocket&quot;</span>
    <span class="hljs-string">&quot;github.com/novalagung/gubrak&quot;</span>
    <span class="hljs-string">&quot;io/ioutil&quot;</span>
    <span class="hljs-string">&quot;log&quot;</span>
    <span class="hljs-string">&quot;net/http&quot;</span>
    <span class="hljs-string">&quot;strings&quot;</span>
)

<span class="hljs-keyword">type</span> M <span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">interface</span>{}

<span class="hljs-keyword">const</span> MESSAGE_NEW_USER = <span class="hljs-string">&quot;New User&quot;</span>
<span class="hljs-keyword">const</span> MESSAGE_CHAT = <span class="hljs-string">&quot;Chat&quot;</span>
<span class="hljs-keyword">const</span> MESSAGE_LEAVE = <span class="hljs-string">&quot;Leave&quot;</span>

<span class="hljs-keyword">var</span> connections = <span class="hljs-built_in">make</span>([]*WebSocketConnection, <span class="hljs-number">0</span>)
</code></pre><p>Konstanta dengan prefix <code>MESSAGE_*</code> adalah representasi dari jenis message yang dikirim dari socket server ke semua client (yang terhubung).</p><ul><li>Konstanta <code>MESSAGE_NEW_USER</code>. Ketika ada user baru terhubung ke room, maka sebuah pesan <strong>User XXX: connected</strong> akan muncul. Konstanta ini digunakan oleh socket server dalam mem-broadcast informasi tersebut.</li><li>Konstanta <code>MESSAGE_CHAT</code>. Ketika user/client mengirim message/pesan ke socket server, message tersebut kemudian diteruskan ke semua client lainnya oleh socket server. Isi pesan di-broadcast oleh socket server ke semua user yang terhubung menggunakan konstanta ini.</li><li>Konstanta <code>MESSAGE_LEAVE</code>. Digunakan oleh socket server untuk menginformasikan semua client lainnya, bahwasanya ada client yang keluar dari room (terputus dengan socket server). Pesan <strong>User XXX: disconnected</strong> dimunculkan.</li></ul><p>Selain 3 konstanta di atas, ada variabel <code>connections</code>. Variabel ini digunakan untuk menampung semua client yang terhubung ke socket server.</p><p>OK, setelah kode di atas ditulis, siapkan tiga buah struct berikut.</p><ul><li><p>Struct <code>SocketPayload</code>, digunakan untuk menampung payload yang dikirim dari front end.</p><pre><code class="lang-go"> <span class="hljs-keyword">type</span> SocketPayload <span class="hljs-keyword">struct</span> {
     Message <span class="hljs-keyword">string</span>
 }
</code></pre></li><li><p>Struct <code>SocketResponse</code>, digunakan oleh back end (socket server) sewaktu mem-broadcast message ke semua client yang terhubung. Field <code>Type</code> akan berisi salah satu dari konstanta dengan prefix <code>MESSAGE_*</code>.</p><pre><code class="lang-go"> <span class="hljs-keyword">type</span> SocketResponse <span class="hljs-keyword">struct</span> {
     From    <span class="hljs-keyword">string</span>
     Type    <span class="hljs-keyword">string</span>
     Message <span class="hljs-keyword">string</span>
 }
</code></pre></li><li><p>Struct <code>WebSocketConnection</code>. Nantinya setiap client yang terhubung, objek koneksi-nya disimpan ke slice <code>connections</code> yang tipenya adalah <code>[]*WebSocketConnection</code>.</p><pre><code class="lang-go"> <span class="hljs-keyword">type</span> WebSocketConnection <span class="hljs-keyword">struct</span> {
     *websocket.Conn
     Username <span class="hljs-keyword">string</span>
 }
</code></pre></li></ul><p>Selanjutnya buat fungsi <code>main()</code>, siapkan satu buah rute, <code>/</code>, isinya menampilkan template view <code>index.html</code>. Siapkan juga rute <code>/ws</code> yang akan menjadi gateway komunikasi socket.</p><pre><code class="lang-go"><span class="hljs-keyword">func</span> main() {
    http.HandleFunc(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-keyword">func</span>(w http.ResponseWriter, r *http.Request) {
        content, err := ioutil.ReadFile(<span class="hljs-string">&quot;index.html&quot;</span>)
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            http.Error(w, <span class="hljs-string">&quot;Could not open requested file&quot;</span>, http.StatusInternalServerError)
            <span class="hljs-keyword">return</span>
        }

        fmt.Fprintf(w, <span class="hljs-string">&quot;%s&quot;</span>, content)
    })

    http.HandleFunc(<span class="hljs-string">&quot;/ws&quot;</span>, <span class="hljs-keyword">func</span>(w http.ResponseWriter, r *http.Request) {
        <span class="hljs-comment">// socket code here</span>
    })

    fmt.Println(<span class="hljs-string">&quot;Server starting at :8080&quot;</span>)
    http.ListenAndServe(<span class="hljs-string">&quot;:8080&quot;</span>, <span class="hljs-literal">nil</span>)
}
</code></pre><p>Handler <code>/ws</code> diisi dengan proses untuk konversi koneksi HTTP ke koneksi web socket. Statement <code>websocket.Upgrade()</code> digunakan untuk ini. Pada statement tersebut, parameter ke-4 adalah besar read buffer, sedangkan parameter ke-5 adalah besar write buffer.</p><pre><code class="lang-go">http.HandleFunc(<span class="hljs-string">&quot;/ws&quot;</span>, <span class="hljs-keyword">func</span>(w http.ResponseWriter, r *http.Request) {
    currentGorillaConn, err := websocket.Upgrade(w, r, w.Header(), <span class="hljs-number">1024</span>, <span class="hljs-number">1024</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        http.Error(w, <span class="hljs-string">&quot;Could not open websocket connection&quot;</span>, http.StatusBadRequest)
    }

    username := r.URL.Query().Get(<span class="hljs-string">&quot;username&quot;</span>)
    currentConn := WebSocketConnection{Conn: currentGorillaConn, Username: username}
    connections = <span class="hljs-built_in">append</span>(connections, &amp;currentConn)

    <span class="hljs-keyword">go</span> handleIO(&amp;currentConn, connections)
})
</code></pre><p>Di sisi client, ketika inisialisasi koneksi web socket, informasi <strong>username</strong> disisipkan sebagai query string. Lalu di back end diambil untuk ditempelkan ke objek koneksi socket (yang kemudian dimasukan ke <code>connections</code>).</p><pre><code class="lang-js">app.ws = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">&quot;ws://localhost:8080/ws?username=&quot;</span> + name)
</code></pre><p>Objek <code>currentGorillaConn</code> yang merupakan objek <em>current</em> koneksi web server, kita cast ke tipe <code>WebSocketConnection</code>, kemudian ditampung ke <code>currentConn</code>. Informasi username di atas ditambahkan sebagai identifier dalam objek tersebut.</p><p>Slice <code>connections</code> menampung semua koneksi web socket, termasuk <code>currentConn</code>.</p><p>Di akhir handler, fungsi <code>handleIO()</code> dipanggil sebagai sebuah goroutine, dalam pemanggilannya objek <code>currentConn</code> dan <code>connections</code> disisipkan. Tugas fungsi <code>handleIO()</code> ini adalah untuk me-manage komunikasi antara client dan server. Proses broadcast message ke semua client yg terhubung dilakukan dalam fungsi ini.</p><p>Berikut adalah isi fungsi <code>handleIO()</code>.</p><pre><code class="lang-go"><span class="hljs-keyword">func</span> handleIO(currentConn *WebSocketConnection, connections []*WebSocketConnection) {
    <span class="hljs-keyword">defer</span> <span class="hljs-keyword">func</span>() {
        <span class="hljs-keyword">if</span> r := <span class="hljs-built_in">recover</span>(); r != <span class="hljs-literal">nil</span> {
            log.Println(<span class="hljs-string">&quot;ERROR&quot;</span>, fmt.Sprintf(<span class="hljs-string">&quot;%v&quot;</span>, r))
        }
    }()

    broadcastMessage(currentConn, MESSAGE_NEW_USER, <span class="hljs-string">&quot;&quot;</span>)

    <span class="hljs-keyword">for</span> {
        payload := SocketPayload{}
        err := currentConn.ReadJSON(&amp;payload)
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            <span class="hljs-keyword">if</span> strings.Contains(err.Error(), <span class="hljs-string">&quot;websocket: close&quot;</span>) {
                broadcastMessage(currentConn, MESSAGE_LEAVE, <span class="hljs-string">&quot;&quot;</span>)
                ejectConnection(currentConn)
                <span class="hljs-keyword">return</span>
            }

            log.Println(<span class="hljs-string">&quot;ERROR&quot;</span>, err.Error())
            <span class="hljs-keyword">continue</span>
        }

        broadcastMessage(currentConn, MESSAGE_CHAT, payload.Message)
    }
}
</code></pre><p>Ketika koneksi terjalin untuk pertama kalinya, antara socket client dan socket server, fungsi <code>broadcastMessage()</code> dipanggil. Semua client yang terhubung (kecuali <code>currentConn</code>) dikirimi pesan dengan jenis <code>MESSAGE_NEW_USER</code>, menginformasikan bahwa ada user baru terhubung ke room.</p><p>Selanjutnya, ada perulangan tanpa henti. Statement <code>currentConn.ReadJSON()</code> dalam loop adalah blocking. Statement tersebut hanya akan tereksekusi ketika ada payload (berupa message/pesan) dikirim dari socket client. Payload tersebut diterima oleh socket server, kemudian di-broadcast ke semua client yang terhubung (kecuali <code>currentConn</code>) dengan jenis message terpilih adalah <code>MESSAGE_CHAT</code>. Data message sendiri disisipkan sebagai parameter ke-3 pemanggilan <code>broadcastMessage()</code>.</p><p>Ketika ada client terputus koneksinya dengan socket server, method <code>.ReadJSON()</code> otomatis terpanggil, namun tidak melakukan apa-apa dan <strong>pasti</strong> mengembalikan error. Berikut adalah error message-nya.</p><pre><code>websocket: close 1001 (going away)
</code></pre><p>Error diatas adalah indikator bahwa <em>current</em> client terputus koneksinya dengan socket server. Ketika hal ini terjadi, maka akan ada message yang di-broadcast ke semua client yang terhubung (kecuali <code>currentConn</code>) dengan jenis message adalah <code>MESSAGE_LEAVE</code>, untuk menginformasikan bahwa ada user (yaitu <code>currentConn</code>) yang leave room. Tak lupa, objek <code>currentConn</code> dikeluarkan dari slice <code>connections</code> lewat fungsi <code>ejectConnection()</code>.</p><p>Berikut adalah deklarasi fungsi <code>ejectConnection()</code> dan <code>broadcastMessage()</code>.</p><ul><li><p>Fungsi <code>ejectConnection()</code>:</p><pre><code class="lang-go"> <span class="hljs-keyword">func</span> ejectConnection(currentConn *WebSocketConnection) {
     filtered, _ := gubrak.Reject(connections, <span class="hljs-keyword">func</span>(each *WebSocketConnection) <span class="hljs-keyword">bool</span> {
         <span class="hljs-keyword">return</span> each == currentConn
     })
     connections = filtered.([]*WebSocketConnection)
 }
</code></pre></li><li><p>Fungsi <code>broadcastMessage()</code>:</p><pre><code class="lang-go"> <span class="hljs-keyword">func</span> broadcastMessage(currentConn *WebSocketConnection, kind, message <span class="hljs-keyword">string</span>) {
     <span class="hljs-keyword">for</span> _, eachConn := <span class="hljs-keyword">range</span> connections {
         <span class="hljs-keyword">if</span> eachConn == currentConn {
             <span class="hljs-keyword">continue</span>
         }

         eachConn.WriteJSON(SocketResponse{
             From:    currentConn.Username,
             Type:    kind,
             Message: message,
         })
     }
 }
</code></pre></li></ul><p>Method <code>.WriteJSON()</code> milik <code>websocket.Conn</code> digunakan untuk mengirim data dari socket server ke socket client (yang direpresentasikan oleh <code>eachConn</code>). Dalam fungsi <code>broadcastMessage()</code> di atas, semua client yang terhubung dikirimi data (sesuai parameter), terkecuali untuk current client.</p><p>Bagian back end sudah cukup. Sekarang lanjut ke layer front end.</p><h2 id="cb282-front-end">CB.28.2. Front End</h2><p>Siapkan terlebih dahulu basis layout front end. Ada dua section penting yg harus disiapkan.</p><ol><li>Sebuah div dengan ukuran besar, nantinya diisi dengan message yang dikirim oleh current client dan client lainnya.</li><li>Sebuah form dengan isi satu inputan text dan satu button. Nantinya user menulis pesan yang ingin di-broadcast ke inputan text, lalu klik button untuk submit message tersebut.</li></ol><p>Kurang lebih kode-nya seperti berikut.</p><pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>WebSocket<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/css&quot;</span>&gt;</span><span class="undefined">
        // styles here
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onsubmit</span>=<span class="hljs-string">&quot;app.doSendMessage(); return false;&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;placeholder&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Hello <span class="hljs-tag">&lt;<span class="hljs-name">b</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>. Say something:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;input-message&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Enter message&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>Send<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="actionscript">
        <span class="hljs-comment">// js script here</span>
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre><p>Tambahkan beberapa stylesheet agar terlihat cantik.</p><pre><code class="lang-css"><span class="hljs-selector-class">.form</span> {
    <span class="hljs-attribute">position</span>: fixed;
    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f9f9f9</span>;
    <span class="hljs-attribute">border-top</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#78b8ef</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">5px</span> <span class="hljs-number">10px</span>;
}
<span class="hljs-selector-class">.form</span> <span class="hljs-selector-class">.placeholder</span>, <span class="hljs-selector-class">.form</span> <span class="hljs-selector-class">.input-message</span>, <span class="hljs-selector-class">.form</span> <span class="hljs-selector-tag">button</span> {
    <span class="hljs-attribute">display</span>: block;
    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">5px</span>;
}
<span class="hljs-selector-class">.form</span> <span class="hljs-selector-class">.input-message</span> {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">7px</span>;
    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ecebeb</span>;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
    <span class="hljs-attribute">width</span>: -webkit-fill-available;
}
<span class="hljs-selector-class">.form</span> <span class="hljs-selector-tag">button</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">color</span>: white;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">7px</span> <span class="hljs-number">10px</span>;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#78b8ef</span>;
    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#5a9ed8</span>;
}
<span class="hljs-selector-class">.container</span> { <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">50px</span>; }
<span class="hljs-selector-class">.container</span> <span class="hljs-selector-tag">p</span> { <span class="hljs-attribute">display</span>: block; }
</code></pre><p>Tampilan sekilas aplikasi bisa dilihat pada gambar di bawah ini.</p><p><img alt="Chatting App Template"src="images/C.28_1_template.png"></p><p>OK, sekarang saatnya masuk ke bagian yang paling disukai anak jaman now (?), yaitu javascript. Siapkan beberapa property, satu untuk menampung objek client socket server, dan satu lagi menampung element container (element inilah yang nantinya akan diisi message yang di-broadcast oleh server).</p><pre><code class="lang-js"><span class="hljs-keyword">var</span> app = {}
app.ws = <span class="hljs-literal">undefined</span>
app.container = <span class="hljs-literal">undefined</span>

app.init = <span class="hljs-function"><span class="hljs-keyword">function</span> () </span>{
    <span class="hljs-keyword">if</span> (!(<span class="hljs-built_in">window</span>.WebSocket)) {
        alert(<span class="hljs-string">&apos;Your browser does not support WebSocket&apos;</span>)
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">var</span> name = prompt(<span class="hljs-string">&apos;Enter your name please:&apos;</span>) || <span class="hljs-string">&quot;No name&quot;</span>
    <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&apos;.username&apos;</span>).innerText = name

    app.container = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&apos;.container&apos;</span>)

    app.ws = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">&quot;ws://localhost:8080/ws?username=&quot;</span> + name)

    <span class="hljs-comment">// ...</span>
}

<span class="hljs-built_in">window</span>.onload = app.init
</code></pre><p>Fungsi <code>app.init()</code> dipanggil pada event <code>window.onload</code>.</p><p>Di saat pertama kali page load, muncul prompt yang meminta inputan nama user. Nantinya user yang diinput dijadikan sebagai <em>current</em> username pada aplikasi chatting ini.</p><p><img alt="Prompt Username"src="images/C.28_2_prompt_username.png"></p><p>Property <code>app.ws</code> digunakan untuk menampung objek client web socket. Dari objek tersebut, buat 3 buah event listener. Tulis deklarasi event-nya dalam <code>app.init</code>.</p><ul><li><p>Event <code>onopen</code>. Event ini dieksekusi ketika <em>current</em> socket client berhasil terhubung dengan socket server.</p><pre><code class="lang-js"> app.ws.onopen = <span class="hljs-function"><span class="hljs-keyword">function</span>() </span>{
     <span class="hljs-keyword">var</span> message = <span class="hljs-string">&apos;&lt;b&gt;me&lt;/b&gt;: connected&apos;</span>
     app.print(message)
 }
</code></pre></li><li><p>Event <code>onmessage</code>. Event ini terpanggil ketika socket server mengirim data dan diterima oleh masing-masing socket client. Di dalam event init, message yang di-broadcast oleh socket server ditampilkan sesuai jenis message-nya, apakah <code>New User</code>, <code>Leave</code>, atau <code>Chat</code>.</p><pre><code class="lang-js"> app.ws.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
     <span class="hljs-keyword">var</span> res = <span class="hljs-built_in">JSON</span>.parse(event.data)

     <span class="hljs-keyword">var</span> messsage = <span class="hljs-string">&apos;&apos;</span>
     <span class="hljs-keyword">if</span> (res.Type === <span class="hljs-string">&apos;New User&apos;</span>) {
         message = <span class="hljs-string">&apos;User &lt;b&gt;&apos;</span> + res.From + <span class="hljs-string">&apos;&lt;/b&gt;: connected&apos;</span>
     } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (res.Type === <span class="hljs-string">&apos;Leave&apos;</span>) {
         message = <span class="hljs-string">&apos;User &lt;b&gt;&apos;</span> + res.From + <span class="hljs-string">&apos;&lt;/b&gt;: disconnected&apos;</span>
     } <span class="hljs-keyword">else</span> {
         message = <span class="hljs-string">&apos;&lt;b&gt;&apos;</span> + res.From + <span class="hljs-string">&apos;&lt;/b&gt;: &apos;</span> + res.Message 
     }

     app.print(message)
 }
</code></pre></li><li><p>Event <code>onclose</code>. Seperti yang sudah disinggung di atas, ketika koneksi <em>current</em> socket terputus dengan server, event ini terpanggil secara otomatis.</p><pre><code class="lang-js"> app.ws.onclose = <span class="hljs-function"><span class="hljs-keyword">function</span> () </span>{
     <span class="hljs-keyword">var</span> message = <span class="hljs-string">&apos;&lt;b&gt;me&lt;/b&gt;: disconnected&apos;</span>
     app.print(message)
 }
</code></pre></li></ul><p>Kemudian tambahkan fungsi <code>app.print()</code>, fungsi ini digunakan untuk mencetak pesan ke <code>.container</code>.</p><pre><code class="lang-js">app.print = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">message</span>) </span>{
    <span class="hljs-keyword">var</span> el = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&quot;p&quot;</span>)
    el.innerHTML = message
    app.container.append(el)
}
</code></pre><p>Dan fungsi <code>app.doSendMessage()</code>, fungsi ini digunakan untuk mengirim payload message (inputan user) ke socket server.</p><pre><code class="lang-js">app.doSendMessage = <span class="hljs-function"><span class="hljs-keyword">function</span> () </span>{
    <span class="hljs-keyword">var</span> messageRaw = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&apos;.input-message&apos;</span>).value
    app.ws.send(<span class="hljs-built_in">JSON</span>.stringify({
        Message: messageRaw
    }));

    <span class="hljs-keyword">var</span> message = <span class="hljs-string">&apos;&lt;b&gt;me&lt;/b&gt;: &apos;</span> + messageRaw
    app.print(message)

    <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&apos;.input-message&apos;</span>).value = <span class="hljs-string">&apos;&apos;</span>
}
</code></pre><p>OK, aplikasi sudah siap, mari lanjut ke bagian testing.</p><h2 id="cb283-testing">CB.28.3. Testing</h2><p>Buka beberapa tab, gunakan username apa saja di masing-masing tab. Coba berinteraksi satu sama lain.</p><p><img alt="Chatting App"src="images/C.28_3_chatting.png"></p><p>Bisa dilihat, ketika ada user baru, semua client yang sudah terhubung mendapat pesan <strong>User XXX: connected</strong>.</p><p>Pesan yang ditulis oleh satu client bisa dilihat oleh client lainnya.</p><p>Ketika salah satu user leave, pesan <strong>User XXX: disconnected</strong> akan di-broadcast ke semua user lainnya. Pada gambar di bawah ini dicontohkan user <strong>Noval Agung</strong> leave.</p><p><img alt="User leave chat room"src="images/C.28_4_user_leave.png"></p><hr><ul><li><a href="https://github.com/gorilla/websocket"target="_blank">Gorilla Web Socket</a>, by Gary Burd, BSD-2-Clause License</li><li><a href="https://github.com/novalagung/gubrak"target="_blank">Gubrak</a>, by Noval Agung, MIT License</li></ul></section></div><div class="search-results"><div class="has-results"><h1 class="search-results-title">results matching ""</h1></div><div class="no-results"><h1 class="search-results-title">No results matching ""</h1></div></div></div></div></div></div><a href="C-27-golang-ssh-sftp.html"class="navigation navigation-prev"aria-label="Previous page: C.27. SSH & SFTP"></a><a href="C-29-golang-protobuf-implementation.html"class="navigation navigation-next"aria-label="Next page: C.29. Protobuf"></a></div><script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{title:"C.28. Web Socket: Chatting App",level:"1.4.27",depth:2,next:{title:"C.29. Protobuf",level:"1.4.28",depth:2,path:"C-29-golang-protobuf-implementation.md",ref:"C-29-golang-protobuf-implementation.md",articles:[]},previous:{title:"C.27. SSH & SFTP",level:"1.4.26",depth:2,path:"C-27-golang-ssh-sftp.md",ref:"C-27-golang-ssh-sftp.md",articles:[]},dir:"ltr"},config:{plugins:["ga","html-minifier","disqus","meta","sitemap","scripts"],styles:{website:"styles/website.css"},pluginsConfig:{disqus:{useIdentifier:!1,shortName:"dasarpemrogramangolang"},meta:{content:"",data:[{name:"google-site-verification",content:"UZnxS2Dk3fm2_Elms3a__56Q_oQ3sQ1h0SVXXlHSmbE"},{name:"og:image",content:"https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg"},{name:"twitter:image",content:"https://dasarpemrogramangolang.novalagung.com/images/cover_fb_share.jpg"}],name:""},scripts:{files:[]},search:{},"html-minifier":{customAttrSurround:[],removeScriptTypeAttributes:!1,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeEmptyElements:!0,sortClassName:!0,caseSensitive:!0,html5:!0,collapseWhitespace:!0,processConditionalComments:!1,quoteCharacter:null,keepClosingSlash:!0,preventAttributesEscaping:!1,minifyURLs:!1,removeAttributeQuotes:!1,decodeEntities:!1,trimCustomFragments:!1,customAttrAssign:[],includeAutoGeneratedTags:!0,collapseInlineTagWhitespace:!1,collapseBooleanAttributes:!0,minifyJS:!0,removeTagWhitespace:!0,preserveLineBreaks:!1,sortAttributes:!0,removeStyleLinkTypeAttributes:!1,removeComments:!0,minifyCSS:!0,processScripts:[],conservativeCollapse:!1,removeOptionalTags:!1,useShortDoctype:!1},lunr:{maxIndexSize:1e6,ignoreSpecialCharacters:!1},fontsettings:{theme:"white",family:"sans",size:2},highlight:{},sitemap:{hostname:"https://dasarpemrogramangolang.novalagung.com/"},ga:{configuration:"auto",token:"UA-27602984-29"},sharing:{facebook:!0,twitter:!0,google:!1,weibo:!1,instapaper:!1,vk:!1,all:["facebook","google","twitter","weibo","instapaper"]},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1}},theme:"default",lunr:{maxIndexSize:1e9},pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},variables:{},gitbook:"*"},file:{path:"C-28-golang-web-socket.md",mtime:"2018-10-01T02:03:35.438Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2018-12-07T00:59:33.615Z"},basePath:".",book:{language:""}})})</script></div><script src="gitbook/gitbook.js"></script><script src="gitbook/theme.js"></script><script src="gitbook/gitbook-plugin-ga/plugin.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script><script src="gitbook/gitbook-plugin-disqus/plugin.js"></script><script src="gitbook/gitbook-plugin-search/search-engine.js"></script><script src="gitbook/gitbook-plugin-search/search.js"></script><script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script><script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script><script src="gitbook/gitbook-plugin-sharing/buttons.js"></script><script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script></body></html>